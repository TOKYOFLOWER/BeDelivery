<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>èŠ±å®šæœŸé…é€ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã€ç®¡ç†è€…ã€‘</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸŒ¸</text></svg>">
  <style>
    .header { background: linear-gradient(135deg, #7b1fa2, #512da8); }
    .admin-badge {
      background: rgba(255,255,255,0.2);
      padding: 4px 10px;
      border-radius: 4px;
      font-size: 0.75rem;
      margin-left: 10px;
    }

      /* --- ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ --- */
  .import-section {
    background: linear-gradient(135deg, #e8eaf6, #c5cae9);
    border: 2px dashed #7986cb;
    border-radius: 12px;
    padding: 20px 24px;
    margin-bottom: 24px;
  }
  .import-section h3 {
    margin: 0 0 12px 0;
    color: #283593;
    font-size: 1.05rem;
  }
  .import-section-row {
    display: flex;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
  }
  .btn-import {
    background: linear-gradient(135deg, #5c6bc0, #3949ab);
    color: #fff;
    border: none;
    padding: 10px 24px;
    border-radius: 8px;
    font-size: 0.95rem;
    cursor: pointer;
    transition: all 0.2s;
    display: inline-flex;
    align-items: center;
    gap: 8px;
  }
  .btn-import:hover {
    background: linear-gradient(135deg, #3949ab, #283593);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(57,73,171,0.35);
  }
  .import-hint {
    color: #5c6bc0;
    font-size: 0.82rem;
  }

  /* --- ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ€ãƒ« --- */
  .import-modal-content {
    max-width: 900px;
    width: 95%;
  }

  /* ãƒ‰ãƒ­ãƒƒãƒ—ã‚¾ãƒ¼ãƒ³ */
  .import-drop-zone {
    border: 2px dashed #bdbdbd;
    border-radius: 12px;
    padding: 40px 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.25s;
    background: #fafafa;
    margin-bottom: 16px;
  }
  .import-drop-zone:hover,
  .import-drop-zone.drag-over {
    border-color: #5c6bc0;
    background: #e8eaf6;
  }
  .import-drop-zone .drop-icon {
    font-size: 2.5rem;
    display: block;
    margin-bottom: 8px;
  }
  .import-drop-zone .drop-text {
    color: #757575;
    font-size: 0.9rem;
  }
  .import-drop-zone .drop-text strong {
    color: #5c6bc0;
    cursor: pointer;
  }
  .import-file-name {
    color: #5c6bc0;
    font-weight: bold;
    margin-top: 4px;
    font-size: 0.9rem;
  }

  /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
  .import-preview-section {
    margin-top: 20px;
  }
  .import-summary {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    margin-bottom: 16px;
  }
  .import-count {
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 500;
  }
  .import-count-add      { background: #e8f5e9; color: #2e7d32; }
  .import-count-update   { background: #fff8e1; color: #f57f17; }
  .import-count-delete   { background: #ffebee; color: #c62828; }
  .import-count-unchanged { background: #f5f5f5; color: #757575; }

  /* å·®åˆ†ãƒ†ãƒ¼ãƒ–ãƒ« */
  .diff-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.88rem;
  }
  .diff-table th {
    background: #eeeeee;
    padding: 8px 10px;
    text-align: left;
    font-weight: 600;
    font-size: 0.82rem;
    border-bottom: 2px solid #bdbdbd;
  }
  .diff-table td {
    padding: 8px 10px;
    border-bottom: 1px solid #e0e0e0;
    vertical-align: top;
  }
  .diff-row-unchanged {
    opacity: 0.55;
  }
  .diff-checkbox-cell {
    width: 32px;
    text-align: center;
  }
  .diff-badge {
    display: inline-block;
    padding: 2px 10px;
    border-radius: 12px;
    font-size: 0.78rem;
    font-weight: 600;
    white-space: nowrap;
  }
  .diff-name-cell {
    white-space: nowrap;
    min-width: 100px;
  }
  .diff-flag {
    display: inline-block;
    background: #e3f2fd;
    color: #1565c0;
    font-size: 0.72rem;
    padding: 1px 6px;
    border-radius: 4px;
    margin-left: 6px;
  }
  .diff-detail-cell {
    max-width: 400px;
  }
  .diff-detail {
    color: #616161;
    font-size: 0.82rem;
  }
  .diff-detail-delete {
    color: #c62828;
    font-style: italic;
  }
  .diff-field {
    font-weight: 600;
    color: #424242;
    margin-right: 4px;
  }
  .diff-change {
    margin-bottom: 4px;
  }
  .diff-old {
    text-decoration: line-through;
    color: #e53935;
    font-size: 0.8rem;
  }
  .diff-new {
    color: #2e7d32;
    font-weight: 500;
  }

  /* å·®åˆ†ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« */
  .diff-table-wrapper {
    max-height: 400px;
    overflow-y: auto;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
  }

  /* ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° */
  .import-loading {
    display: none;
    align-items: center;
    justify-content: center;
    gap: 10px;
    padding: 20px;
    color: #5c6bc0;
  }
  .import-loading .spinner-small {
    width: 20px;
    height: 20px;
    border: 3px solid #e8eaf6;
    border-top: 3px solid #5c6bc0;
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
  }

  /* ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¢ã‚¯ã‚·ãƒ§ãƒ³ */
  .import-actions {
    display: flex;
    justify-content: flex-end;
    gap: 12px;
    margin-top: 20px;
    padding-top: 16px;
    border-top: 1px solid #e0e0e0;
  }
  .btn-import-confirm {
    background: linear-gradient(135deg, #43a047, #2e7d32);
    color: #fff;
    border: none;
    padding: 10px 28px;
    border-radius: 8px;
    font-size: 0.95rem;
    cursor: pointer;
    transition: all 0.2s;
  }
  .btn-import-confirm:hover:not(:disabled) {
    background: linear-gradient(135deg, #2e7d32, #1b5e20);
    transform: translateY(-1px);
  }
  .btn-import-confirm:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }
  </style>
</head>
<body>
  <div class="container">
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="header">
      <h1>ğŸŒ¸ èŠ±å®šæœŸé…é€ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  <span class="admin-badge">ç®¡ç†è€…</span></h1>
      <div class="header-actions">
        <button id="refreshBtn" class="btn btn-secondary">
          <span>ğŸ”„</span> æ›´æ–°
        </button>
        <button id="newOrderBtn" class="btn btn-success">
          <span>â•</span> æ–°è¦æ³¨æ–‡
        </button>
      </div>
    </header>

    <!-- çµ±è¨ˆæƒ…å ± -->
    <div class="stats">
      <div class="stat-card">
        <div class="stat-label">å…¨æ³¨æ–‡</div>
        <div class="stat-value" id="statTotal">-</div>
      </div>
      <div class="stat-card stat-new">
        <div class="stat-label">æœªå‡¦ç†</div>
        <div class="stat-value" id="statNew">-</div>
      </div>
      <div class="stat-card stat-processing">
        <div class="stat-label">å‡¦ç†ä¸­</div>
        <div class="stat-value" id="statProcessing">-</div>
      </div>
      <div class="stat-card stat-shipped">
        <div class="stat-label">å‡ºè·æ¸ˆ</div>
        <div class="stat-value" id="statShipped">-</div>
      </div>
      <div class="stat-card stat-cancelled">
        <div class="stat-label">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</div>
        <div class="stat-value" id="statCancelled">-</div>
      </div>
    </div>

    <!-- ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="download-section">
      <h3>ğŸ“¥ åŠ©ãƒã‚³å½¢å¼ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</h3>
      <div class="download-buttons">
        <button id="downloadActiveBtn" class="btn btn-primary">
          <span>ğŸ“¥</span> æœ‰åŠ¹ãªæ³¨æ–‡ã®ã¿ï¼ˆæœªå‡¦ç†ãƒ»å‡¦ç†ä¸­ï¼‰
        </button>
        <button id="downloadFilteredBtn" class="btn btn-secondary">
          <span>ğŸ“¥</span> ãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        </button>
        <button id="downloadAllBtn" class="btn btn-secondary">
          <span>ğŸ“¥</span> å…¨ä»¶ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        </button>
      </div>
    </div>

    <!-- ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="import-section">
      <h3>ğŸ“¤ Excelã‚¤ãƒ³ãƒãƒ¼ãƒˆ</h3>
      <div class="import-section-row">
        <button id="importBtn" class="btn-import">
          <span>ğŸ“</span> xlsxãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–ã‚Šè¾¼ã‚€
        </button>
        <span class="import-hint">
          ãŠèŠ±å®›å…ˆãƒªã‚¹ãƒˆ(.xlsx)ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ã€æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã¨ç…§åˆãƒ»ä¸€æ‹¬æ›´æ–°ã§ãã¾ã™
        </span>
      </div>
    </div>

    <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
    <div class="filters">
      <div class="filter-group">
        <label for="statusFilter">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</label>
        <select id="statusFilter" class="filter-select">
          <option value="">ã™ã¹ã¦</option>
          <option value="æœªå‡¦ç†">æœªå‡¦ç†</option>
          <option value="å‡¦ç†ä¸­">å‡¦ç†ä¸­</option>
          <option value="å‡ºè·æ¸ˆ">å‡ºè·æ¸ˆ</option>
          <option value="ã‚­ãƒ£ãƒ³ã‚»ãƒ«">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</option>
        </select>
      </div>
      <div class="filter-group">
        <label for="searchText">æ¤œç´¢</label>
        <input type="text" id="searchText" class="filter-input" placeholder="å—æ³¨ç•ªå·ã€æ³¨æ–‡è€…åã€å•†å“åãªã©">
      </div>
      <div class="filter-group">
        <label for="fromDate">æ³¨æ–‡æ—¥ï¼ˆã‹ã‚‰ï¼‰</label>
        <input type="date" id="fromDate" class="filter-input">
      </div>
      <div class="filter-group">
        <label for="toDate">æ³¨æ–‡æ—¥ï¼ˆã¾ã§ï¼‰</label>
        <input type="date" id="toDate" class="filter-input">
      </div>
      <button id="applyFilterBtn" class="btn btn-secondary">ãƒ•ã‚£ãƒ«ã‚¿é©ç”¨</button>
    </div>

    <!-- æ³¨æ–‡ä¸€è¦§ -->
    <div class="table-container">
      <table class="order-table">
        <thead>
          <tr>
            <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
            <th>å—æ³¨ç•ªå·</th>
            <th>æ³¨æ–‡æ—¥</th>
            <th>ãŠå±Šã‘å¸Œæœ›æ—¥</th>
            <th>æ³¨æ–‡è€…</th>
            <th>ãŠå±Šã‘å…ˆ</th>
            <th>å•†å“å</th>
            <th>å€‹æ•°</th>
            <th>å˜ä¾¡</th>
            <th>æ“ä½œ</th>
          </tr>
        </thead>
        <tbody id="orderTableBody">
          <tr>
            <td colspan="10" class="empty-message">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™...</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° -->
  <div id="loading" class="loading" style="display: none;">
    <div class="spinner"></div>
    <p>èª­ã¿è¾¼ã¿ä¸­...</p>
  </div>

  <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
  <div id="message" class="message" style="display: none;"></div>

  <!-- æ³¨æ–‡ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="orderModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modalTitle">æ–°è¦æ³¨æ–‡ç™»éŒ²</h2>
        <button class="modal-close" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body">
        <form id="orderForm">
          <!-- åŸºæœ¬æƒ…å ± -->
          <fieldset>
            <legend>åŸºæœ¬æƒ…å ±</legend>
            <div class="form-row">
              <div class="form-group">
                <label for="orderDate">æ³¨æ–‡æ—¥ *</label>
                <input type="date" id="orderDate" required>
              </div>
              <div class="form-group">
                <label for="deliveryDate">ãŠå±Šã‘å¸Œæœ›æ—¥</label>
                <input type="date" id="deliveryDate">
              </div>
              <div class="form-group">
                <label for="paymentMethod">æ±ºæ¸ˆæ–¹æ³•</label>
                <select id="paymentMethod">
                  <option value="åº—é ­æ‰•ã„">åº—é ­æ‰•ã„</option>
                  <option value="ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰">ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰</option>
                  <option value="éŠ€è¡ŒæŒ¯è¾¼">éŠ€è¡ŒæŒ¯è¾¼</option>
                  <option value="ä»£é‡‘å¼•æ›">ä»£é‡‘å¼•æ›</option>
                  <option value="è«‹æ±‚æ›¸æ‰•ã„">è«‹æ±‚æ›¸æ‰•ã„</option>
                </select>
              </div>
            </div>
          </fieldset>

          <!-- æ³¨æ–‡è€…æƒ…å ± -->
          <fieldset>
            <legend>æ³¨æ–‡è€…æƒ…å ±</legend>
            <div class="form-row">
              <div class="form-group">
                <label for="customerLastName">å§“ *</label>
                <input type="text" id="customerLastName" required>
              </div>
              <div class="form-group">
                <label for="customerFirstName">å *</label>
                <input type="text" id="customerFirstName" required>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="customerLastNameKana">å§“ã‚«ãƒŠ</label>
                <input type="text" id="customerLastNameKana">
              </div>
              <div class="form-group">
                <label for="customerFirstNameKana">åã‚«ãƒŠ</label>
                <input type="text" id="customerFirstNameKana">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="customerCompany">ä¼šç¤¾å</label>
                <input type="text" id="customerCompany">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="customerZipCode">éƒµä¾¿ç•ªå· *</label>
                <input type="text" id="customerZipCode" placeholder="1234567" required>
              </div>
              <div class="form-group">
                <label for="customerPrefecture">éƒ½é“åºœçœŒ *</label>
                <input type="text" id="customerPrefecture" required>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="customerCity">å¸‚åŒºç”ºæ‘ *</label>
                <input type="text" id="customerCity" required>
              </div>
              <div class="form-group">
                <label for="customerAddress">ä½æ‰€è©³ç´° *</label>
                <input type="text" id="customerAddress" required>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="customerBuilding">å»ºç‰©å</label>
                <input type="text" id="customerBuilding">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="customerPhone">é›»è©±ç•ªå· *</label>
                <input type="tel" id="customerPhone" placeholder="03-1234-5678" required>
              </div>
              <div class="form-group">
                <label for="customerEmail">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ *</label>
                <input type="email" id="customerEmail" required>
              </div>
            </div>
          </fieldset>

          <!-- ãŠå±Šã‘å…ˆæƒ…å ± -->
          <fieldset>
            <legend>ãŠå±Šã‘å…ˆæƒ…å ±</legend>
            <div class="form-row">
              <button type="button" class="btn btn-secondary" onclick="copyCustomerInfo()">
                ğŸ“‹ æ³¨æ–‡è€…æƒ…å ±ã‚’ã‚³ãƒ”ãƒ¼
              </button>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="recipientLastName">å§“ *</label>
                <input type="text" id="recipientLastName" required>
              </div>
              <div class="form-group">
                <label for="recipientFirstName">å *</label>
                <input type="text" id="recipientFirstName" required>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="recipientLastNameKana">å§“ã‚«ãƒŠ</label>
                <input type="text" id="recipientLastNameKana">
              </div>
              <div class="form-group">
                <label for="recipientFirstNameKana">åã‚«ãƒŠ</label>
                <input type="text" id="recipientFirstNameKana">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="recipientZipCode">éƒµä¾¿ç•ªå· *</label>
                <input type="text" id="recipientZipCode" placeholder="1234567" required>
              </div>
              <div class="form-group">
                <label for="recipientPrefecture">éƒ½é“åºœçœŒ *</label>
                <input type="text" id="recipientPrefecture" required>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="recipientCity">å¸‚åŒºç”ºæ‘ *</label>
                <input type="text" id="recipientCity" required>
              </div>
              <div class="form-group">
                <label for="recipientAddress">ä½æ‰€è©³ç´° *</label>
                <input type="text" id="recipientAddress" required>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="recipientBuilding">å»ºç‰©å</label>
                <input type="text" id="recipientBuilding">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="recipientPhone">é›»è©±ç•ªå· *</label>
                <input type="tel" id="recipientPhone" placeholder="03-1234-5678" required>
              </div>
              <div class="form-group">
                <label for="deliveryTime">é…é€æ™‚é–“å¸¯</label>
                <select id="deliveryTime">
                  <option value="">æŒ‡å®šãªã—</option>
                  <option value="åˆå‰ä¸­">åˆå‰ä¸­</option>
                  <option value="14æ™‚-16æ™‚">14æ™‚-16æ™‚</option>
                  <option value="16æ™‚-18æ™‚">16æ™‚-18æ™‚</option>
                  <option value="18æ™‚-20æ™‚">18æ™‚-20æ™‚</option>
                  <option value="19æ™‚-21æ™‚">19æ™‚-21æ™‚</option>
                </select>
              </div>
            </div>
          </fieldset>

          <!-- å•†å“æƒ…å ± -->
          <fieldset>
            <legend>å•†å“æƒ…å ±</legend>
            <div class="form-row">
              <div class="form-group">
                <label for="productCode">å•†å“ã‚³ãƒ¼ãƒ‰ *</label>
                <input type="text" id="productCode" required>
              </div>
              <div class="form-group">
                <label for="productName">å•†å“å *</label>
                <input type="text" id="productName" required>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="quantity">å€‹æ•° *</label>
                <input type="number" id="quantity" min="1" value="1" required>
              </div>
              <div class="form-group">
                <label for="unitPrice">å˜ä¾¡ï¼ˆç¨è¾¼ï¼‰ *</label>
                <input type="number" id="unitPrice" min="0" required>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group full-width">
                <label for="orderRemarks">å‚™è€ƒï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚«ãƒ¼ãƒ‰å†…å®¹ãªã©ï¼‰</label>
                <textarea id="orderRemarks" rows="4"></textarea>
              </div>
            </div>
          </fieldset>

          <div class="form-actions">
            <button type="button" class="btn btn-secondary" onclick="closeModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
            <button type="submit" class="btn btn-primary">ä¿å­˜</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="statusModal" class="modal">
    <div class="modal-content status-modal-content">
      <div class="modal-header">
        <h2>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´</h2>
        <button class="modal-close" onclick="closeStatusModal()">&times;</button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="statusOrderKey">
        
        <dl class="status-info">
          <dt>å—æ³¨ç•ªå·</dt>
          <dd id="statusOrderNumber">-</dd>
          <dt>ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</dt>
          <dd id="currentStatus">-</dd>
        </dl>
        
        <div class="form-group">
          <label for="newStatus">æ–°ã—ã„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</label>
          <select id="newStatus" class="filter-select" style="width: 100%;">
            <option value="æœªå‡¦ç†">æœªå‡¦ç†</option>
            <option value="å‡¦ç†ä¸­">å‡¦ç†ä¸­</option>
            <option value="å‡ºè·æ¸ˆ">å‡ºè·æ¸ˆ</option>
            <option value="ã‚­ãƒ£ãƒ³ã‚»ãƒ«">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</option>
          </select>
        </div>
        
        <div class="form-group" style="margin-top: 16px;">
          <label for="statusMemo">ãƒ¡ãƒ¢</label>
          <textarea id="statusMemo" rows="3" class="filter-input" style="width: 100%;"></textarea>
        </div>
        
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" onclick="closeStatusModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
          <button type="button" class="btn btn-primary" onclick="updateStatus()">æ›´æ–°</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="importModal" class="modal">
    <div class="modal-content import-modal-content">
      <div class="modal-header">
        <h2>ğŸ“¤ Excelã‚¤ãƒ³ãƒãƒ¼ãƒˆ</h2>
        <button class="modal-close" onclick="closeImportModal()">&times;</button>
      </div>
      <div class="modal-body">

        <!-- ãƒ‰ãƒ­ãƒƒãƒ—ã‚¾ãƒ¼ãƒ³ -->
        <div id="importDropZone" class="import-drop-zone" onclick="document.getElementById('importFile').click()">
          <span class="drop-icon">ğŸ“</span>
          <div class="drop-text">
            xlsxãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã“ã“ã«ãƒ‰ãƒ­ãƒƒãƒ—ã€ã¾ãŸã¯<strong>ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ</strong>
          </div>
          <div id="importFileName" class="import-file-name"></div>
        </div>
        <input type="file" id="importFile" accept=".xlsx,.xls" style="display:none;">

        <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° -->
        <div id="importLoading" class="import-loading">
          <div class="spinner-small"></div>
          <span>ãƒ‡ãƒ¼ã‚¿ã‚’è§£æä¸­...</span>
        </div>

        <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div id="importPreviewSection" class="import-preview-section" style="display:none;">
          <h3 style="margin: 0 0 12px; font-size: 1rem;">ç…§åˆçµæœ</h3>

          <!-- ã‚µãƒãƒªãƒ¼ -->
          <div id="importSummary" class="import-summary"></div>

          <!-- å·®åˆ†ãƒ†ãƒ¼ãƒ–ãƒ« -->
          <div class="diff-table-wrapper">
            <table class="diff-table">
              <thead>
                <tr>
                  <th style="width:32px;">
                    <input type="checkbox" id="importCheckAll" checked
                           onchange="toggleAllImportChecks(this.checked)">
                  </th>
                  <th style="width:70px;">ç¨®åˆ¥</th>
                  <th style="width:120px;">å®›å</th>
                  <th>å¤‰æ›´å†…å®¹</th>
                </tr>
              </thead>
              <tbody id="importPreviewBody"></tbody>
            </table>
          </div>

          <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
          <div class="import-actions">
            <button type="button" class="btn btn-secondary" onclick="closeImportModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
            <button type="button" id="importConfirmBtn" class="btn-import-confirm" disabled>
              ã‚¤ãƒ³ãƒãƒ¼ãƒˆå¯¾è±¡ã‚’é¸æŠã—ã¦ãã ã•ã„
            </button>
          </div>
        </div>

      </div>
    </div>
  </div>
  
  <script src="config.js"></script>
  <script src="app.js"></script>

  <!-- SheetJS (xlsx ãƒ‘ãƒ¼ã‚µãƒ¼) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <!-- ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½ -->
  <script src="import.js"></script>
  <script>
    // import.js ã®ãƒªã‚¹ãƒŠãƒ¼ã‚’åˆæœŸåŒ–ï¼ˆapp.js ã® setupEventListeners ã¨åŒæ§˜ï¼‰
    document.addEventListener('DOMContentLoaded', function() {
      setupImportListeners();
    });

    // å…¨ãƒã‚§ãƒƒã‚¯ãƒˆã‚°ãƒ«
    function toggleAllImportChecks(checked) {
      document.querySelectorAll('.import-check').forEach(cb => {
        cb.checked = checked;
        const idx = parseInt(cb.dataset.index);
        if (importDiffData[idx]) {
          importDiffData[idx].checked = checked;
        }
      });
      updateImportButtonCount();
    }

    // ãƒ¢ãƒ¼ãƒ€ãƒ«å¤–ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹ï¼ˆæ—¢å­˜ã® window.onclick ã‚’æ‹¡å¼µï¼‰
    const originalOnClick = window.onclick;
    window.onclick = function(event) {
      if (originalOnClick) originalOnClick(event);
      const importModal = document.getElementById('importModal');
      if (event.target === importModal) {
        closeImportModal();
      }
    };
  </script>
  
</body>
</html>
